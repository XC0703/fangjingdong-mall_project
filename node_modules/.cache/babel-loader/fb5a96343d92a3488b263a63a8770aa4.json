{"ast":null,"code":"import { computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute } from 'vue-router';\nimport { useCommonCartEffect } from './commonCartEffect'; // 购物车数据获取相关的逻辑\n\nconst useCartEffect = () => {\n  // 使用store存储\n  const store = useStore();\n  let cartCount = store.state.cartList; // 获取路由\n\n  const route = useRoute();\n  const shopId = route.params.id; // 计算属性\n  //就是获取 state 中对应店铺的数据，然后在 computed 中来个循环，\n  //循环商铺里的所有商品信息，把他们的 count 值加一起就行。\n\n  const total = computed(() => {\n    let cartShop = cartCount[shopId];\n    let count = 0;\n\n    if (cartShop) {\n      for (let i in cartShop) {\n        const product = cartShop[i];\n        count += product.count;\n      }\n    }\n\n    return count;\n  });\n  const price = computed(() => {\n    let cartShop = cartCount[shopId];\n    let pricesum = 0;\n\n    if (cartShop) {\n      for (let i in cartShop) {\n        const product = cartShop[i];\n        pricesum += product.price * product.count;\n      }\n    } // 保留两位小数\n\n\n    return pricesum.toFixed(2);\n  });\n  const productList = computed(() => {\n    let productList = cartCount[shopId] || [];\n    return productList;\n  });\n  return {\n    total,\n    price,\n    productList\n  };\n};\n\nexport default {\n  name: 'CartFooter',\n\n  setup() {\n    const {\n      total,\n      price,\n      productList\n    } = useCartEffect();\n    const {\n      changeCartItemInfo\n    } = useCommonCartEffect();\n    return {\n      total,\n      price,\n      productList,\n      changeCartItemInfo\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAqCA,SAASA,QAAT,QAAyB,KAAzB;AACA,SAASC,QAAT,QAAyB,MAAzB;AACA,SAASC,QAAT,QAAyB,YAAzB;AACA,SAASC,mBAAT,QAAoC,oBAApC,C,CAEA;;AACA,MAAMC,aAAY,GAAI,MAAM;EAC1B;EACA,MAAMC,KAAI,GAAIJ,QAAQ,EAAtB;EACA,IAAIK,SAAQ,GAAID,KAAK,CAACE,KAAN,CAAYC,QAA5B,CAH0B,CAI1B;;EACA,MAAMC,KAAI,GAAIP,QAAQ,EAAtB;EACA,MAAMQ,MAAK,GAAID,KAAK,CAACE,MAAN,CAAaC,EAA5B,CAN0B,CAQ1B;EACA;EACA;;EACA,MAAMC,KAAI,GAAIb,QAAQ,CAAC,MAAI;IACzB,IAAIc,QAAO,GAAIR,SAAS,CAACI,MAAD,CAAxB;IACA,IAAIK,KAAI,GAAI,CAAZ;;IACA,IAAGD,QAAH,EAAY;MACV,KAAK,IAAIE,CAAT,IAAcF,QAAd,EAAuB;QACrB,MAAMG,OAAM,GAAKH,QAAQ,CAACE,CAAD,CAAzB;QACAD,KAAK,IAAEE,OAAO,CAACF,KAAf;MACF;IACF;;IACA,OAAOA,KAAP;EACD,CAVqB,CAAtB;EAYA,MAAMG,KAAI,GAAIlB,QAAQ,CAAC,MAAM;IACzB,IAAIc,QAAO,GAAIR,SAAS,CAACI,MAAD,CAAxB;IACA,IAAIS,QAAO,GAAI,CAAf;;IACA,IAAIL,QAAJ,EAAc;MACZ,KAAK,IAAIE,CAAT,IAAcF,QAAd,EAAwB;QACtB,MAAMG,OAAM,GAAIH,QAAQ,CAACE,CAAD,CAAxB;QACAG,QAAO,IAAMF,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACF,KAArC;MACF;IACF,CARyB,CASzB;;;IACA,OAAOI,QAAQ,CAACC,OAAT,CAAiB,CAAjB,CAAP;EACD,CAXmB,CAAtB;EAaA,MAAMC,WAAU,GAAIrB,QAAQ,CAAC,MAAM;IACjC,IAAIqB,WAAU,GAAIf,SAAS,CAACI,MAAD,CAAT,IAAqB,EAAvC;IACA,OAAOW,WAAP;EACD,CAH2B,CAA5B;EAKA,OAAO;IAACR,KAAD;IAAOK,KAAP;IAAaG;EAAb,CAAP;AACF,CA1CA;;AA2CA,eAAe;EACXC,IAAI,EAAC,YADM;;EAEXC,KAAK,GAAE;IACL,MAAM;MAACV,KAAD;MAAOK,KAAP;MAAaG;IAAb,IAA4BjB,aAAa,EAA/C;IACA,MAAM;MAAEoB;IAAF,IAAyBrB,mBAAmB,EAAlD;IACA,OAAO;MAACU,KAAD;MAAOK,KAAP;MAAaG,WAAb;MAAyBG;IAAzB,CAAP;EACF;;AANW,CAAf","names":["computed","useStore","useRoute","useCommonCartEffect","useCartEffect","store","cartCount","state","cartList","route","shopId","params","id","total","cartShop","count","i","product","price","pricesum","toFixed","productList","name","setup","changeCartItemInfo"],"sourceRoot":"","sources":["D:\\StudySoft\\VSCode\\VSCodeFile\\CODE_前端projects\\fangjingdong-mall_project\\src\\views\\shop\\CartFooter.vue"],"sourcesContent":["<template>\r\n  <div class=\"cart\">\r\n    <div class=\"product\">\r\n        <div \r\n          class=\"product__item\"\r\n          v-for=\"item in productList\"\r\n          :key=\"item._id\"\r\n        >\r\n            <img class=\"product__item__img\" src=\"http://www.dell-lee.com/imgs/vue3/near.png\" />\r\n            <div class=\"product__item__detail\">\r\n              <h4 class=\"product__item__title\">{{item.name}}</h4>\r\n              <p class=\"product__item__price\">\r\n                <span class=\"product__item__yen\">&yen;</span>{{item.price}}\r\n                <span class=\"product__item__origin\">&yen;{{item.oldPrice}}</span>\r\n              </p>\r\n            </div>\r\n            <div class=\"product__number\">\r\n              <span class=\"product__number__minus\" @click=\"()=>{changeCartItemInfo(shopId, item._id, item, -1)}\">-</span>\r\n              {{item.count || 0}}\r\n              <span class=\"product__number__plus\" @click=\"()=>{changeCartItemInfo(shopId, item._id, item, -1)}\">+</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"check\">\r\n      <div class=\"check__icon\">\r\n        <img src=\"http://www.dell-lee.com/imgs/vue3/basket.png\" alt=\"\" class=\"check__icon__img\">\r\n        <div class=\"check__icon__tag\">{{total}}</div>\r\n      </div>\r\n      <div class=\"check__info\">\r\n        总计：<span class=\"check__info__price\">&yen;{{price}}</span>\r\n      </div>\r\n      <div class=\"check__btn\">去结算</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { computed } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRoute } from 'vue-router'\r\nimport { useCommonCartEffect } from './commonCartEffect'\r\n\r\n// 购物车数据获取相关的逻辑\r\nconst useCartEffect = () => {\r\n  // 使用store存储\r\n  const store = useStore()\r\n  let cartCount = store.state.cartList\r\n  // 获取路由\r\n  const route = useRoute()\r\n  const shopId = route.params.id\r\n  \r\n  // 计算属性\r\n  //就是获取 state 中对应店铺的数据，然后在 computed 中来个循环，\r\n  //循环商铺里的所有商品信息，把他们的 count 值加一起就行。\r\n  const total = computed(()=>{\r\n    let cartShop = cartCount[shopId]\r\n    let count = 0;\r\n    if(cartShop){\r\n      for (let i in cartShop){\r\n        const product  = cartShop[i];\r\n        count+=product.count\r\n      }\r\n    }\r\n    return count;\r\n  })\r\n\r\n  const price = computed(() => {\r\n      let cartShop = cartCount[shopId]\r\n      let pricesum = 0\r\n      if (cartShop) {\r\n        for (let i in cartShop) {\r\n          const product = cartShop[i]\r\n          pricesum += (product.price * product.count)\r\n        }\r\n      }\r\n      // 保留两位小数\r\n      return pricesum.toFixed(2)\r\n    })\r\n\r\n  const productList = computed(() => {\r\n    let productList = cartCount[shopId] || []\r\n    return productList\r\n  })\r\n\r\n  return {total,price,productList}\r\n}\r\nexport default {\r\n    name:'CartFooter',\r\n    setup(){\r\n      const {total,price,productList} = useCartEffect();\r\n      const { changeCartItemInfo } = useCommonCartEffect()\r\n      return {total,price,productList,changeCartItemInfo}\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../../style/viriables.scss';\r\n@import '../../style/mixins.scss';\r\n.cart {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n}\r\n.product {\r\n  overflow-y: scroll;\r\n  flex: 1;\r\n  &__item {\r\n    position: relative;\r\n    display: flex;\r\n    padding: .12rem 0;\r\n    margin: 0 .16rem;\r\n    border-bottom: .01rem solid $content-bgcolor;\r\n    &__detail{\r\n      overflow: hidden;\r\n    }\r\n    &__img {\r\n      width: .68rem;\r\n      height: .68rem;\r\n      margin-right: .16rem;\r\n    }\r\n    &__title{\r\n      margin:0;\r\n      line-height:.2rem;\r\n      font-size: .14rem;\r\n      color:$content-fontcolor;\r\n      @include ellipsis;\r\n    }\r\n    &__price{\r\n      margin:0;\r\n      line-height: .2rem;\r\n      font-size: .14rem;\r\n      color:$hightlight-fontColor ;\r\n    }\r\n    &__yen{\r\n      font-size: .12rem;\r\n    }\r\n    &__origin{\r\n      margin-left: .06rem;\r\n      line-height: .2rem;\r\n      font-size: .12rem;\r\n      color:$light-fontColor;\r\n      text-decoration: line-through;\r\n    }\r\n    .product__number{\r\n      position: absolute;\r\n      right:0;\r\n      bottom:.12rem;\r\n      &__minus,&__plus{\r\n        display: inline-block;\r\n        width: .2rem;\r\n        height: .2rem;\r\n        line-height: .16rem;\r\n        border-radius: 50%;\r\n        font-size: .2rem;     \r\n        text-align: center;\r\n      }\r\n      &__minus{\r\n        border: .01rem solid $medium-fontColor;\r\n        color: $medium-fontColor;\r\n        margin-right: .05rem;\r\n      }\r\n      &__plus{\r\n        margin-left: .05rem;\r\n        background-color: #0091ff;\r\n        color: $bgColor;\r\n      }\r\n    }\r\n  }\r\n  \r\n}\r\n.check {\r\n  display: flex;\r\n  height: .49rem;\r\n  border-top: .01rem solid $content-bgcolor;\r\n  line-height: .49rem;\r\n  &__icon {\r\n    position: relative;\r\n    width: .84rem;\r\n    &__img {\r\n      display: block;\r\n      margin: .12rem auto;\r\n      width: .28rem;\r\n      height: .26rem;\r\n    }\r\n    &__tag {\r\n      position: absolute;\r\n      left: .46rem;\r\n      top: .04rem;\r\n      padding: 0 .04rem;\r\n      min-width: .2rem;\r\n      height: .2rem;\r\n      line-height: .2rem;\r\n      background-color: $hightlight-fontColor;\r\n      border-radius: .1rem;\r\n      font-size: .12rem;\r\n      text-align: center;\r\n      color: #fff;\r\n      transform: scale(.5);\r\n      transform-origin: left center;\r\n    }\r\n  }\r\n  &__info {\r\n    flex: 1;\r\n    color: $content-fontcolor;\r\n    font-size: .12rem;\r\n    &__price {\r\n      line-height: .49rem;\r\n      color: $hightlight-fontColor;\r\n      font-size: .18rem;\r\n    }\r\n  }\r\n  &__btn {\r\n    width: .98rem;\r\n    background-color: #4FB0F9;\r\n    text-align: center;\r\n    color: #FFF;\r\n    font-size: .14rem;\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}