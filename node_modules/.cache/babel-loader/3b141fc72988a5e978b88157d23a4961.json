{"ast":null,"code":"import Vuex from 'vuex';\n\nconst setLocalCartList = state => {\n  const {\n    cartList\n  } = state;\n  const cartListString = JSON.stringify(cartList);\n  localStorage.cartList = cartListString;\n};\n\nconst getLocaCartList = () => {\n  // { shopId: {shopName:'', productList:{ productId: {} }}}\n  if (localStorage.cartList) {\n    return JSON.parse(localStorage.cartList);\n  } else {\n    return {};\n  }\n};\n\nexport default Vuex.createStore({\n  state: {\n    cartList: getLocaCartList()\n  },\n  mutations: {\n    changeCartItemInfo(state, payload) {\n      const {\n        shopId,\n        productId,\n        productInfo\n      } = payload;\n      let shopInfo = state.cartList[shopId] || {\n        shopName: '',\n        productList: {}\n      };\n      let product = shopInfo.productList[productId];\n\n      if (!product) {\n        productInfo.count = 0;\n        product = productInfo;\n      }\n\n      product.count = product.count + payload.num;\n\n      if (payload.num > 0) {\n        product.check = true;\n      }\n\n      if (product.count < 0) {\n        product.count = 0;\n      }\n\n      shopInfo.productList[productId] = product;\n      state.cartList[shopId] = shopInfo;\n      setLocalCartList(state);\n    },\n\n    changeShopName(state, payload) {\n      const {\n        shopId,\n        shopName\n      } = payload;\n      const shopInfo = state.cartList[shopId] || {\n        shopName: '',\n        productList: {}\n      };\n      shopInfo.shopName = shopName;\n      state.cartList[shopId] = shopInfo;\n      setLocalCartList(state);\n    },\n\n    changeCartItemChecked(state, payload) {\n      const {\n        shopId,\n        productId\n      } = payload;\n      const product = state.cartList[shopId].productList[productId];\n      product.check = !product.check;\n      setLocalCartList(state);\n    },\n\n    cleanCartProducts(state, payload) {\n      const {\n        shopId\n      } = payload;\n      state.cartList[shopId].productList = {};\n      setLocalCartList(state);\n    },\n\n    setCartItemsChecked(state, payload) {\n      const {\n        shopId\n      } = payload;\n      const products = state.cartList[shopId].productList;\n\n      if (products) {\n        for (let key in products) {\n          const product = products[key];\n          product.check = true;\n        }\n      }\n\n      setLocalCartList(state);\n    }\n\n  }\n});","map":{"version":3,"names":["Vuex","setLocalCartList","state","cartList","cartListString","JSON","stringify","localStorage","getLocaCartList","parse","createStore","mutations","changeCartItemInfo","payload","shopId","productId","productInfo","shopInfo","shopName","productList","product","count","num","check","changeShopName","changeCartItemChecked","cleanCartProducts","setCartItemsChecked","products","key"],"sources":["D:/StudySoft/VSCode/VSCodeFile/CODE_前端projects/fangjingdong-mall_project/src/store/index.js"],"sourcesContent":["import Vuex from 'vuex'\r\n\r\nconst setLocalCartList = (state) => {\r\n  const { cartList } = state\r\n  const cartListString = JSON.stringify(cartList)\r\n  localStorage.cartList = cartListString\r\n}\r\n\r\nconst getLocaCartList = () => {\r\n  // { shopId: {shopName:'', productList:{ productId: {} }}}\r\n  if(localStorage.cartList){\r\n    return JSON.parse(localStorage.cartList) \r\n  }else{\r\n    return {}\r\n  }\r\n}\r\n\r\nexport default Vuex.createStore({\r\n  state: {\r\n    cartList: getLocaCartList()\r\n  },\r\n  mutations: {\r\n    changeCartItemInfo(state, payload) {\r\n      const { shopId, productId, productInfo } = payload\r\n      let shopInfo = state.cartList[shopId] || {\r\n        shopName: '', productList:{}\r\n      }\r\n      let product = shopInfo.productList[productId]\r\n      if(!product) {\r\n        productInfo.count = 0\r\n        product = productInfo\r\n      }\r\n      product.count = product.count + payload.num\r\n      if(payload.num > 0) { product.check = true }\r\n      if(product.count < 0) { product.count = 0 }\r\n      shopInfo.productList[productId] = product\r\n      state.cartList[shopId] = shopInfo\r\n      setLocalCartList(state)\r\n    },\r\n    changeShopName(state, payload) {\r\n      const { shopId, shopName } = payload\r\n      const shopInfo = state.cartList[shopId] || {\r\n        shopName: '', productList:{}\r\n      }\r\n      shopInfo.shopName = shopName\r\n      state.cartList[shopId] = shopInfo\r\n      setLocalCartList(state)\r\n    },\r\n    changeCartItemChecked(state, payload) {\r\n      const { shopId, productId } = payload\r\n      const product = state.cartList[shopId].productList[productId]\r\n      product.check = !product.check\r\n      setLocalCartList(state)\r\n    },\r\n    cleanCartProducts(state, payload) {\r\n      const { shopId } = payload\r\n      state.cartList[shopId].productList = {}\r\n      setLocalCartList(state)\r\n    },\r\n    setCartItemsChecked(state, payload) {\r\n      const { shopId } = payload\r\n      const products = state.cartList[shopId].productList\r\n      if(products) {\r\n        for(let key in products) {\r\n          const product = products[key]\r\n          product.check = true\r\n        }\r\n      }\r\n      setLocalCartList(state)\r\n    }\r\n  }\r\n})\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}