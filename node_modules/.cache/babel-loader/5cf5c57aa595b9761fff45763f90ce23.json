{"ast":null,"code":"import Vuex from 'vuex'; // store存储\n// 现在我们的 cartList 就是一个对象，里面没有存储任何信息，\n//因为只有用户在购物车里进行操作了，才会有数据的存储或改变。\n//当用户点击加号时，先判断 cartList 里有没有存储商铺的信息，\n//没有的话就存储一个空对象，再判断商铺里面有没有选择的商品的信息，\n//没有的话就把传过来的 prodectInfo 进行赋值，再添加一个 count 属性用来统计数量。\n//因为我们现在是增加的操作，所以最后一定得让数量加一，最后再把改变后的数据存储在 state 中。\n\nexport default Vuex.createStore({\n  state: {\n    cartList: {// 第一层级是商铺的id\n      // shopId: {\n      // 第二层是商品id\n      // 第二层内容是商品内容以及购物数量\n      //   productId: {\n      //     _id: '1',\n      //     name: '番茄250g/份',\n      //     imgUrl: 'http://www.dell-lee.com/imgs/vue3/tomato.png',\n      //     sales: 10,\n      //     price: 33.6,\n      //     oldPrice: 39.6,\n      //     count: 2\n      //   },\n      // },\n    }\n  },\n  mutations: {\n    changeCartItemInfo(state, payload) {\n      //state为固定传入的第一个参数，可以向 store.commit 传入额外的参数，即 mutation 的载荷（payload）\n      const {\n        shopId,\n        productId,\n        productInfo,\n        num\n      } = payload;\n      let shopInfo = state.cartList[shopId];\n      console.log(shopId, productId, productInfo, num);\n\n      if (!shopInfo) {\n        shopInfo = {};\n      }\n\n      let product = shopInfo[productId];\n\n      if (!product) {\n        product = productInfo;\n        product.count = 0;\n      }\n\n      product.count = product.count + num;\n\n      if (product.count < 0) {\n        product.count = 0;\n      }\n\n      shopInfo[productId] = product;\n      state.cartList[shopId] = shopInfo;\n    }\n\n  },\n  actions: {},\n  modules: {}\n});","map":{"version":3,"names":["Vuex","createStore","state","cartList","mutations","changeCartItemInfo","payload","shopId","productId","productInfo","num","shopInfo","console","log","product","count","actions","modules"],"sources":["D:/StudySoft/VSCode/VSCodeFile/CODE_前端projects/fangjingdong-mall_project/src/store/index.js"],"sourcesContent":["import Vuex from 'vuex'\r\n\r\n// store存储\r\n// 现在我们的 cartList 就是一个对象，里面没有存储任何信息，\r\n//因为只有用户在购物车里进行操作了，才会有数据的存储或改变。\r\n//当用户点击加号时，先判断 cartList 里有没有存储商铺的信息，\r\n//没有的话就存储一个空对象，再判断商铺里面有没有选择的商品的信息，\r\n//没有的话就把传过来的 prodectInfo 进行赋值，再添加一个 count 属性用来统计数量。\r\n//因为我们现在是增加的操作，所以最后一定得让数量加一，最后再把改变后的数据存储在 state 中。\r\nexport default Vuex.createStore({\r\n  state: {\r\n    cartList: {\r\n      // 第一层级是商铺的id\r\n      // shopId: {\r\n        // 第二层是商品id\r\n        // 第二层内容是商品内容以及购物数量\r\n      //   productId: {\r\n      //     _id: '1',\r\n      //     name: '番茄250g/份',\r\n      //     imgUrl: 'http://www.dell-lee.com/imgs/vue3/tomato.png',\r\n      //     sales: 10,\r\n      //     price: 33.6,\r\n      //     oldPrice: 39.6,\r\n      //     count: 2\r\n      //   },\r\n      // },\r\n    }\r\n  },\r\n  mutations: {\r\n    changeCartItemInfo(state, payload) {//state为固定传入的第一个参数，可以向 store.commit 传入额外的参数，即 mutation 的载荷（payload）\r\n          const { shopId, productId, productInfo,num } = payload\r\n          let shopInfo = state.cartList[shopId]\r\n          console.log(shopId, productId, productInfo,num);\r\n          if (!shopInfo) {\r\n            shopInfo = {}\r\n          }\r\n          let product = shopInfo[productId]\r\n          if (!product) {\r\n            product = productInfo\r\n            product.count = 0\r\n          }\r\n          product.count = product.count + num       \r\n          if (product.count < 0) { product.count = 0 }\r\n          shopInfo[productId] = product\r\n          state.cartList[shopId] = shopInfo\r\n    }\r\n  },\r\n  actions: {\r\n  },\r\n  modules: {\r\n  }\r\n})\r\n"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,MAAjB,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAeA,IAAI,CAACC,WAAL,CAAiB;EAC9BC,KAAK,EAAE;IACLC,QAAQ,EAAE,CACR;MACA;MACE;MACA;MACF;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IAdQ;EADL,CADuB;EAmB9BC,SAAS,EAAE;IACTC,kBAAkB,CAACH,KAAD,EAAQI,OAAR,EAAiB;MAAC;MAC9B,MAAM;QAAEC,MAAF;QAAUC,SAAV;QAAqBC,WAArB;QAAiCC;MAAjC,IAAyCJ,OAA/C;MACA,IAAIK,QAAQ,GAAGT,KAAK,CAACC,QAAN,CAAeI,MAAf,CAAf;MACAK,OAAO,CAACC,GAAR,CAAYN,MAAZ,EAAoBC,SAApB,EAA+BC,WAA/B,EAA2CC,GAA3C;;MACA,IAAI,CAACC,QAAL,EAAe;QACbA,QAAQ,GAAG,EAAX;MACD;;MACD,IAAIG,OAAO,GAAGH,QAAQ,CAACH,SAAD,CAAtB;;MACA,IAAI,CAACM,OAAL,EAAc;QACZA,OAAO,GAAGL,WAAV;QACAK,OAAO,CAACC,KAAR,GAAgB,CAAhB;MACD;;MACDD,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACC,KAAR,GAAgBL,GAAhC;;MACA,IAAII,OAAO,CAACC,KAAR,GAAgB,CAApB,EAAuB;QAAED,OAAO,CAACC,KAAR,GAAgB,CAAhB;MAAmB;;MAC5CJ,QAAQ,CAACH,SAAD,CAAR,GAAsBM,OAAtB;MACAZ,KAAK,CAACC,QAAN,CAAeI,MAAf,IAAyBI,QAAzB;IACL;;EAjBQ,CAnBmB;EAsC9BK,OAAO,EAAE,EAtCqB;EAwC9BC,OAAO,EAAE;AAxCqB,CAAjB,CAAf"},"metadata":{},"sourceType":"module"}