{"ast":null,"code":"import { computed } from 'vue';\nimport { useStore } from 'vuex'; // 购物车相关逻辑\n\nexport const useCommonCartEffect = shopId => {\n  const store = useStore();\n  const cartList = store.state.cartList; // 执行购物函数\n\n  const changeCartItemInfo = (shopId, productId, productInfo, num) => {\n    store.commit('changeCartItemInfo', {\n      shopId,\n      productId,\n      productInfo,\n      num\n    });\n  }; // 购物车数据不希望有数量为空的商品\n\n\n  const productList = computed(() => {\n    const productList = cartList[shopId]?.productList || {};\n    const notEmptyProductList = {};\n\n    for (let i in productList) {\n      const product = productList[i];\n\n      if (product.count > 0) {\n        notEmptyProductList[i] = product;\n      }\n    }\n\n    return notEmptyProductList;\n  }); // 获取商铺名称\n\n  const shopName = computed(() => {\n    const shopName = cartList[shopId]?.shopName || '';\n    return shopName;\n  }); // 获取购物车商品总数量及总价\n\n  const calculations = computed(() => {\n    const productList = cartList[shopId]?.productList;\n    const result = {\n      total: 0,\n      price: 0,\n      allChecked: true\n    };\n\n    if (productList) {\n      for (let i in productList) {\n        const product = productList[i];\n        result.total += product.count;\n\n        if (product.check) {\n          result.price += product.count * product.price;\n        }\n\n        if (product.count > 0 && !product.check) {\n          result.allChecked = false;\n        }\n      }\n    }\n\n    result.price = result.price.toFixed(2);\n    return result;\n  });\n  return {\n    cartList,\n    shopName,\n    productList,\n    calculations,\n    changeCartItemInfo\n  };\n};","map":{"version":3,"names":["computed","useStore","useCommonCartEffect","shopId","store","cartList","state","changeCartItemInfo","productId","productInfo","num","commit","productList","notEmptyProductList","i","product","count","shopName","calculations","result","total","price","allChecked","check","toFixed"],"sources":["D:/StudySoft/VSCode/VSCodeFile/CODE_前端projects/fangjingdong-mall_project/src/effects/cartEffects.js"],"sourcesContent":["import { computed } from 'vue'\r\nimport { useStore } from 'vuex'\r\n// 购物车相关逻辑\r\nexport const useCommonCartEffect = (shopId) => {\r\n  const store = useStore()\r\n  const cartList = store.state.cartList;\r\n  // 执行购物函数\r\n  const changeCartItemInfo = (shopId, productId, productInfo, num) => {\r\n    store.commit('changeCartItemInfo', {\r\n      shopId, productId, productInfo, num\r\n    })\r\n  }\r\n  \r\n  // 购物车数据不希望有数量为空的商品\r\n  const productList = computed(() => {\r\n    const productList = cartList[shopId]?.productList || {}\r\n    const notEmptyProductList = {}\r\n    for(let i in productList) {\r\n      const product = productList[i]\r\n      if(product.count > 0 ) {\r\n        notEmptyProductList[i] = product\r\n      }\r\n    }\r\n    return notEmptyProductList\r\n  })\r\n  // 获取商铺名称\r\n  const shopName = computed(() => {\r\n    const shopName = cartList[shopId]?.shopName || ''\r\n    return shopName\r\n  })\r\n// 获取购物车商品总数量及总价\r\n  const calculations = computed(() => {\r\n    const productList = cartList[shopId]?.productList\r\n    const result = { total: 0, price: 0, allChecked: true}\r\n    if(productList) {\r\n       for(let i in productList) {\r\n         const product = productList[i]\r\n         result.total += product.count\r\n         if(product.check) {\r\n           result.price += (product.count * product.price)\r\n         }\r\n         if(product.count > 0 && !product.check) {\r\n           result.allChecked = false\r\n         }\r\n      }\r\n    }\r\n    result.price = result.price.toFixed(2)\r\n    return result\r\n  })\r\n\r\n  return { cartList, shopName, productList, calculations, changeCartItemInfo }\r\n}"],"mappings":"AAAA,SAASA,QAAT,QAAyB,KAAzB;AACA,SAASC,QAAT,QAAyB,MAAzB,C,CACA;;AACA,OAAO,MAAMC,mBAAmB,GAAIC,MAAD,IAAY;EAC7C,MAAMC,KAAK,GAAGH,QAAQ,EAAtB;EACA,MAAMI,QAAQ,GAAGD,KAAK,CAACE,KAAN,CAAYD,QAA7B,CAF6C,CAG7C;;EACA,MAAME,kBAAkB,GAAG,CAACJ,MAAD,EAASK,SAAT,EAAoBC,WAApB,EAAiCC,GAAjC,KAAyC;IAClEN,KAAK,CAACO,MAAN,CAAa,oBAAb,EAAmC;MACjCR,MADiC;MACzBK,SADyB;MACdC,WADc;MACDC;IADC,CAAnC;EAGD,CAJD,CAJ6C,CAU7C;;;EACA,MAAME,WAAW,GAAGZ,QAAQ,CAAC,MAAM;IACjC,MAAMY,WAAW,GAAGP,QAAQ,CAACF,MAAD,CAAR,EAAkBS,WAAlB,IAAiC,EAArD;IACA,MAAMC,mBAAmB,GAAG,EAA5B;;IACA,KAAI,IAAIC,CAAR,IAAaF,WAAb,EAA0B;MACxB,MAAMG,OAAO,GAAGH,WAAW,CAACE,CAAD,CAA3B;;MACA,IAAGC,OAAO,CAACC,KAAR,GAAgB,CAAnB,EAAuB;QACrBH,mBAAmB,CAACC,CAAD,CAAnB,GAAyBC,OAAzB;MACD;IACF;;IACD,OAAOF,mBAAP;EACD,CAV2B,CAA5B,CAX6C,CAsB7C;;EACA,MAAMI,QAAQ,GAAGjB,QAAQ,CAAC,MAAM;IAC9B,MAAMiB,QAAQ,GAAGZ,QAAQ,CAACF,MAAD,CAAR,EAAkBc,QAAlB,IAA8B,EAA/C;IACA,OAAOA,QAAP;EACD,CAHwB,CAAzB,CAvB6C,CA2B/C;;EACE,MAAMC,YAAY,GAAGlB,QAAQ,CAAC,MAAM;IAClC,MAAMY,WAAW,GAAGP,QAAQ,CAACF,MAAD,CAAR,EAAkBS,WAAtC;IACA,MAAMO,MAAM,GAAG;MAAEC,KAAK,EAAE,CAAT;MAAYC,KAAK,EAAE,CAAnB;MAAsBC,UAAU,EAAE;IAAlC,CAAf;;IACA,IAAGV,WAAH,EAAgB;MACb,KAAI,IAAIE,CAAR,IAAaF,WAAb,EAA0B;QACxB,MAAMG,OAAO,GAAGH,WAAW,CAACE,CAAD,CAA3B;QACAK,MAAM,CAACC,KAAP,IAAgBL,OAAO,CAACC,KAAxB;;QACA,IAAGD,OAAO,CAACQ,KAAX,EAAkB;UAChBJ,MAAM,CAACE,KAAP,IAAiBN,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACM,KAAzC;QACD;;QACD,IAAGN,OAAO,CAACC,KAAR,GAAgB,CAAhB,IAAqB,CAACD,OAAO,CAACQ,KAAjC,EAAwC;UACtCJ,MAAM,CAACG,UAAP,GAAoB,KAApB;QACD;MACH;IACF;;IACDH,MAAM,CAACE,KAAP,GAAeF,MAAM,CAACE,KAAP,CAAaG,OAAb,CAAqB,CAArB,CAAf;IACA,OAAOL,MAAP;EACD,CAjB4B,CAA7B;EAmBA,OAAO;IAAEd,QAAF;IAAYY,QAAZ;IAAsBL,WAAtB;IAAmCM,YAAnC;IAAiDX;EAAjD,CAAP;AACD,CAhDM"},"metadata":{},"sourceType":"module"}